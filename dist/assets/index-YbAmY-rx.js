(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))m(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const e of r.addedNodes)e.tagName==="LINK"&&e.rel==="modulepreload"&&m(e)}).observe(document,{childList:!0,subtree:!0});function u(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function m(t){if(t.ep)return;t.ep=!0;const r=u(t);fetch(t.href,r)}})();const S="modulepreload",E=function(p,l){return new URL(p,l).href},v={},h=function(l,u,m){let t=Promise.resolve();if(u&&u.length>0){let i=function(s){return Promise.all(s.map(c=>Promise.resolve(c).then(n=>({status:"fulfilled",value:n}),n=>({status:"rejected",reason:n}))))};const e=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),a=o?.nonce||o?.getAttribute("nonce");t=i(u.map(s=>{if(s=E(s,m),s in v)return;v[s]=!0;const c=s.endsWith(".css"),n=c?'[rel="stylesheet"]':"";if(!!m)for(let f=e.length-1;f>=0;f--){const g=e[f];if(g.href===s&&(!c||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${n}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":S,c||(d.as="script"),d.crossOrigin="",d.href=s,a&&d.setAttribute("nonce",a),document.head.appendChild(d),c)return new Promise((f,g)=>{d.addEventListener("load",f),d.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${s}`)))})}))}function r(e){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=e,window.dispatchEvent(o),!o.defaultPrevented)throw e}return t.then(e=>{for(const o of e||[])o.status==="rejected"&&r(o.reason);return l().catch(r)})};(async()=>{if(window.__triviaGameLoaded){console.log("▶️ Trivia Game: Ya inicializado. Saltando.");return}window.__triviaGameLoaded=!0,console.log("▶️ Trivia Game: Inicializando...");function p(e,o){if(e.parentElement.querySelector(`#${o}`)){console.log(`🎨 CSS <style> de prueba "${o}" ya inyectado.`);return}try{console.log("🎨 Inyectando CSS de prueba (borde rojo)...");const a="* { border: 5px solid red !important; }";console.log("🎨 Creando <style> para CSS de prueba junto a",e);const i=document.createElement("style");i.id=o,i.textContent=a,e.parentElement.insertBefore(i,e),console.log(`✅ <style> CSS de prueba "${o}" inyectado correctamente.`)}catch(a){console.error("❌ Error al inyectar el CSS de prueba como <style> tag:",a)}}function l(e){document.readyState==="interactive"||document.readyState==="complete"?e():document.addEventListener("DOMContentLoaded",e,{once:!0})}const{createGameManager:u}=await h(async()=>{const{createGameManager:e}=await import("./manager-D21duDoR.js");return{createGameManager:e}},[],import.meta.url),{createUIManager:m}=await h(async()=>{const{createUIManager:e}=await import("./uiManager-DJgQLliD.js");return{createUIManager:e}},[],import.meta.url);async function t(){console.log("🚀 Ejecutando main()...");const e=document.getElementById("main-container");e?p(e,"trivia-main-styles"):console.error("❌ No se encontró #main-container para inyectar el CSS."),document.documentElement.classList.remove("tw-pending");let o=[];try{const n=await fetch(`https://narrativas.ideal.es/juego-historia/events.json?t=${Date.now()}`);if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);o=await n.json(),console.log("✅ Eventos cargados correctamente.")}catch(n){console.error("❌ No se pudieron cargar los eventos:",n),e&&(e.innerHTML='<p style="text-align: center; padding: 2rem; color: red;">Error: No se pudieron cargar los datos del juego.</p>');return}const a=u(o),i=m();a.onStateChange=n=>i.update(n);const s={onStartGame:()=>a.startGame(),onConfirmPlacement:(n,y)=>a.confirmPlacement(n,y),onToggleCardExpansion:n=>a.toggleCardExpansion(n)};i.init(s),i.update(a.state),console.log("🧩 Juego y UI inicializados.");const c=localStorage.getItem("triviaGameState");if(c){console.log("💾 Partida guardada encontrada.");const n=JSON.parse(c);i.showResumeGameModal(()=>a.resumeGame(n),()=>{a.clearGameState(),a.startGame()})}}function r(){l(t)}document.getElementById("main-container")?(console.log("✅ Contenedor principal encontrado. Lanzando app..."),r()):(console.warn("⚠️ Contenedor principal no encontrado. Esperando a que aparezca dinámicamente..."),new MutationObserver((o,a)=>{document.getElementById("main-container")&&(console.log("✅ Contenedor principal detectado por MutationObserver. Lanzando app."),a.disconnect(),r())}).observe(document.body,{childList:!0,subtree:!0}))})();
