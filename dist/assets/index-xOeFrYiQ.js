(function(){const l=document.createElement("link").relList;if(l&&l.supports&&l.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))m(t);new MutationObserver(t=>{for(const a of t)if(a.type==="childList")for(const e of a.addedNodes)e.tagName==="LINK"&&e.rel==="modulepreload"&&m(e)}).observe(document,{childList:!0,subtree:!0});function u(t){const a={};return t.integrity&&(a.integrity=t.integrity),t.referrerPolicy&&(a.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?a.credentials="include":t.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function m(t){if(t.ep)return;t.ep=!0;const a=u(t);fetch(t.href,a)}})();const S="modulepreload",E=function(f,l){return new URL(f,l).href},h={},v=function(l,u,m){let t=Promise.resolve();if(u&&u.length>0){let i=function(s){return Promise.all(s.map(c=>Promise.resolve(c).then(n=>({status:"fulfilled",value:n}),n=>({status:"rejected",reason:n}))))};const e=document.getElementsByTagName("link"),o=document.querySelector("meta[property=csp-nonce]"),r=o?.nonce||o?.getAttribute("nonce");t=i(u.map(s=>{if(s=E(s,m),s in h)return;h[s]=!0;const c=s.endsWith(".css"),n=c?'[rel="stylesheet"]':"";if(!!m)for(let p=e.length-1;p>=0;p--){const g=e[p];if(g.href===s&&(!c||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${s}"]${n}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":S,c||(d.as="script"),d.crossOrigin="",d.href=s,r&&d.setAttribute("nonce",r),document.head.appendChild(d),c)return new Promise((p,g)=>{d.addEventListener("load",p),d.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${s}`)))})}))}function a(e){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=e,window.dispatchEvent(o),!o.defaultPrevented)throw e}return t.then(e=>{for(const o of e||[])o.status==="rejected"&&a(o.reason);return l().catch(a)})},w=""+new URL("index-fXeqy35x.css",import.meta.url).href;(async()=>{if(window.__triviaGameLoaded){console.log("▶️ Trivia Game: Ya inicializado. Saltando.");return}window.__triviaGameLoaded=!0,console.log("▶️ Trivia Game: Inicializando...");async function f(e,o,r){if(o.parentElement.querySelector(`#${r}`)){console.log(`🎨 CSS <style> "${r}" ya inyectado.`);return}try{console.log(`🎨 Descargando CSS desde ${e} para inyectar como <style>...`);const i=await fetch(e);if(!i.ok)throw new Error(`Error al descargar CSS: ${i.status} ${i.statusText}`);const s=await i.text();console.log("🎨 Creando <style> para CSS inyectado junto a",o);const c=document.createElement("style");c.id=r,c.textContent=s,o.parentElement.insertBefore(c,o),console.log(`✅ <style> CSS "${r}" inyectado correctamente.`)}catch(i){console.error("❌ Error al inyectar el CSS como <style> tag:",i)}}function l(e){document.readyState==="interactive"||document.readyState==="complete"?e():document.addEventListener("DOMContentLoaded",e,{once:!0})}const{createGameManager:u}=await v(async()=>{const{createGameManager:e}=await import("./manager-D21duDoR.js");return{createGameManager:e}},[],import.meta.url),{createUIManager:m}=await v(async()=>{const{createUIManager:e}=await import("./uiManager-DJgQLliD.js");return{createUIManager:e}},[],import.meta.url);async function t(){console.log("🚀 Ejecutando main()...");const e=document.getElementById("main-container");e?await f(w,e,"trivia-main-styles"):console.error("❌ No se encontró #main-container para inyectar el CSS."),document.documentElement.classList.remove("tw-pending");let o=[];try{const n=await fetch(`https://narrativas.ideal.es/juego-historia/events.json?t=${Date.now()}`);if(!n.ok)throw new Error(`HTTP error! status: ${n.status}`);o=await n.json(),console.log("✅ Eventos cargados correctamente.")}catch(n){console.error("❌ No se pudieron cargar los eventos:",n),e&&(e.innerHTML='<p style="text-align: center; padding: 2rem; color: red;">Error: No se pudieron cargar los datos del juego.</p>');return}const r=u(o),i=m();r.onStateChange=n=>i.update(n);const s={onStartGame:()=>r.startGame(),onConfirmPlacement:(n,y)=>r.confirmPlacement(n,y),onToggleCardExpansion:n=>r.toggleCardExpansion(n)};i.init(s),i.update(r.state),console.log("🧩 Juego y UI inicializados.");const c=localStorage.getItem("triviaGameState");if(c){console.log("💾 Partida guardada encontrada.");const n=JSON.parse(c);i.showResumeGameModal(()=>r.resumeGame(n),()=>{r.clearGameState(),r.startGame()})}}function a(){l(t)}document.getElementById("main-container")?(console.log("✅ Contenedor principal encontrado. Lanzando app..."),a()):(console.warn("⚠️ Contenedor principal no encontrado. Esperando a que aparezca dinámicamente..."),new MutationObserver((o,r)=>{document.getElementById("main-container")&&(console.log("✅ Contenedor principal detectado por MutationObserver. Lanzando app."),r.disconnect(),a())}).observe(document.body,{childList:!0,subtree:!0}))})();
