@layer theme, base, components, utilities;
@import "tailwindcss";

body {
    touch-action: none;
}

#timeline-wrapper {
    max-height: 100%;
}

#timeline {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 32px;
    /* Padding vertical aumentado para mejorar el área de drop, especialmente arriba y abajo */
    padding: 4rem 0;
    -ms-overflow-style: none;  /* IE y Edge */
    scrollbar-width: none;  /* Firefox */
    transition: gap 0.3s ease-in-out;
}

/* Oculta la línea global que ya no se usa */
#timeline::before {
    display: none;
}

/* Estilo para la tarjeta que está en juego */
#next-card-container .card {
    border: 1px solid rgba(130, 180, 255, 0.7);
}

#next-card-container .card::after {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-radius: 0.5rem; /* Tailwind 'rounded-lg' */
    box-shadow: 0 0 20px rgba(130, 180, 255, 0.6);
    pointer-events: none;
    z-index: 1;
}


/* Segmentos de línea para cada tarjeta en el timeline */
.card-in-timeline {
    position: relative;
}

.card-in-timeline::before, .card-in-timeline::after {
    content: '';
    position: absolute;
    
    width: 4px;
    left: calc(50% - 2px);
    background-color: #cbd5e0; /* Tailwind gray-300 */
    z-index: 1;
}



.card-in-timeline::after {
    height: 32px; /* Should match the padding-bottom */
    bottom: -32px; /* Position in the gap below */
}

/* Ocultar segmentos de línea en los extremos */
#timeline .card-in-timeline:last-child::after {
    display: none;
}

/* --- Transitions for Density --- */
.card-content {
    transition: all 0.3s ease-in-out;
}

.card-content h3,
.card-content p {
    transition: font-size 0.3s ease-in-out, opacity 0.3s ease-in-out;
}

.card-content img {
    transition: width 0.3s ease-in-out, height 0.3s ease-in-out, opacity 0.3s ease-in-out;
}


/* --- Reglas de Densidad --- */

#timeline.very-dense-view .card:not(.is-being-placed) {
    cursor: pointer;
}

#timeline.very-dense-view .card:not(.is-being-placed) .card-content h3 { font-size: 0.875rem; }
#timeline.very-dense-view .card:not(.is-being-placed) .card-content p { display: none; opacity: 0; }
#timeline.very-dense-view .card:not(.is-being-placed) .card-content img { display: none; opacity: 0; }

/* Anular el modo denso para las tarjetas expandidas */
#timeline.very-dense-view .card.is-expanded .card-content h3 { font-size: 1.125rem; }
#timeline.very-dense-view .card.is-expanded .card-content p {
    display: block;
    opacity: 1;
}
#timeline.very-dense-view .card.is-expanded .card-content img {
    display: block;
    opacity: 1;
}


/* --- Estilos Generales de Tarjetas --- */

.year-badge {
    position: absolute;
    left: 50%;
    top: 0;
    transform: translate(-50%, -50%);
    transition: background-color 0.3s ease-in-out;
    z-index: 2;
}

.container-blur {
    filter: blur(4px);
    transition: filter 0.2s ease-in-out;
}

.card-ghost {
    opacity: 0.4;
    background: #4a5568;
}





.correct .year-badge {
    background-color: #10B981;
}

.incorrect .year-badge {
    background-color: #EF4444;
}

.anchor-card {
    box-shadow: 0 0 15px rgba(110, 160, 255, 0.4);
    border: 1px solid rgba(110, 160, 255, 0.5);
}

#timeline .anchor-card {
    box-shadow: none;
}

.card {
    transition: border-left-color 0.4s ease-in-out;
}

.card.correct {
    border-left: 5px solid #10B981;
}

.card.incorrect {
    border-left: 5px solid #EF4444;
}

.card-blur {
    filter: blur(2px);
    pointer-events: none;
}

.confirm-overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    background-color: rgba(255, 255, 255, 0.5); /* White with opacity */
    z-index: 10;
}

/* --- Ocultar scrollbar --- */
#timeline::-webkit-scrollbar {
    display: none; /* Chrome, Safari, Opera */
}

/* --- Animaciones --- */
@keyframes fade-in-up {
    from {
        opacity: 0;
        transform: translateY(20px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.card-entering {
    animation: fade-in-up 0.4s ease-out;
}

@keyframes score-jump {
    0% { transform: scale(1); }
    50% { transform: scale(1.25); }
    100% { transform: scale(1); }
}

.animate-jump {
    animation: score-jump 0.3s ease-in-out;
}

@keyframes streak-flash {
    0%, 100% { color: inherit; }
    50% { color: #f59e0b; /* amber-500 */ }
}

.animate-flash {
    animation: streak-flash 0.5s ease-in-out;
}

@keyframes fade-out-up {
    from {
        opacity: 1;
        transform: translateY(0);
    }
    to {
        opacity: 0;
        transform: translateY(-20px);
    }
}

.streak-popup {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    left: 0;
    right: 0;
    margin: auto;
    
    max-width: 50%;
    padding: 0.5rem 1rem;
    border-radius: 9999px;
    background-color: #f59e0b; /* amber-500 */
    color: white;
    font-weight: bold;
    animation: fade-out-up 1.5s ease-out forwards;
    pointer-events: none;
    z-index: 20;
}

/* --- Estilos para Móviles --- */
@media (max-width: 640px) {
    .card-content h3 {
        font-size: 1rem; /* Reducido de text-lg */
    }
    .card-content p {
        font-size: 0.875rem; /* Reducido de text-sm */
    }
    .card-content img {
        width: 4rem; /* 64px */
        height: 4rem; /* 64px */
    }

    .streak-popup {
        max-width: 80%;
    }
}
